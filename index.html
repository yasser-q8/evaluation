<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نموذج تقييم المطعم - شركة نايف للأغذية | Restaurant Evaluation Form - Naif Food Company</title>
    <!-- إضافة أيقونة شعار الشركة Add company logo icon -->
    <link rel="icon" href="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" type="image/jpeg">
    <!-- مكتبات JavaScript لإنشاء PDF JavaScript libraries for PDF creation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #8B0000;
            --secondary-color: #B22222;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --gold-color: #ffd700;
            --light-bg: #f8f9fa;
            --border-color: #dee2e6;
            --red-light: #ffeaea;
            --red-medium: #ffcccc;
            --red-dark: #cc0000;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding-bottom: 50px;
            font-size: 90%;
        }
        
        .container {
            max-width: 1300px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* رأس الصفحة Page Header */
        .header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 0;
            text-align: center;
            border-bottom: 5px solid var(--gold-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
            position: relative;
        }
        
        /* زر تبديل اللغة Language Toggle Button */
        .language-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
        }
        
        .lang-btn {
            padding: 8px 15px;
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .lang-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid white;
            margin-left: 10px;
        }
        
        .header h1 {
            font-size: 26px;
            margin-bottom: 8px;
        }
        
        .header p {
            font-size: 15px;
            opacity: 0.9;
        }
        
        /* اختيار المطعم Restaurant Selection */
        .restaurant-selector {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
        }
        
        .restaurant-info {
            flex: 1;
            min-width: 300px;
        }
        
        .restaurant-search-container {
            position: relative;
            width: 100%;
        }
        
        #restaurant-search {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 15px;
            margin-top: 8px;
            background-color: white;
        }
        
        .restaurant-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 0 0 5px 5px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .restaurant-dropdown-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        
        .restaurant-dropdown-item:hover {
            background-color: #f5f5f5;
        }
        
        .restaurant-details {
            flex: 1;
            min-width: 300px;
            padding-right: 20px;
        }
        
        .restaurant-details p {
            margin: 8px 0;
            font-size: 16px;
            font-weight: bold;
        }
        
        .evaluator-input {
            flex: 1;
            min-width: 300px;
            margin-top: 15px;
        }
        
        .evaluator-input input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 15px;
            margin-top: 8px;
        }
        
        /* مخطط الدائرة المركزية Central Diagram */
        .diagram-section {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            text-align: center;
        }
        
        .diagram-title {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 20px;
            font-weight: bold;
        }
        
        .diagram-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            height: 450px;
            margin: 0 auto;
        }
        
        .center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90px; /* نصف الحجم الأصلي Half of original size */
            height: 90px; /* نصف الحجم الأصلي Half of original size */
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.2);
            border: 6px solid white;
        }
        
        .center-text {
            color: white;
            font-weight: bold;
            font-size: 10px; /* تم تصغير الخط Line size reduced */
            text-align: center;
            padding: 10px;
            line-height: 1.2;
        }
        
        .axis-box {
            position: absolute;
            width: 180px;
            height: 110px; /* ارتفاع أقل لتلائم الخطوط الأصغر Less height to accommodate smaller text */
            background-color: white;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border: 3px solid;
            padding: 10px; /* مساحة داخلية أقل Less padding */
            z-index: 5;
            transition: all 0.3s ease;
        }
        
        .axis-box:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }
        
        .axis-box.top-left {
            top: 15%;
            right: 10%;
            border-color: #B22222;
        }
        
        .axis-box.top-right {
            top: 15%;
            left: 10%;
            border-color: #8B0000;
        }
        
        .axis-box.bottom-left {
            bottom: 15%;
            right: 10%;
            border-color: #A52A2A;
        }
        
        .axis-box.bottom-right {
            bottom: 15%;
            left: 10%;
            border-color: #DC143C;
        }
        
        .axis-title {
            font-weight: bold;
            margin-bottom: 3px; /* مسافة أقل Less margin */
            font-size: 12px; /* تم تصغير الخط Line size reduced */
        }
        
        .axis-score {
            font-size: 18px; /* تم تصغير الخط Line size reduced */
            font-weight: bold;
            margin: 3px 0; /* مسافة أقل Less margin */
        }
        
        .axis-total {
            font-size: 14px; /* تم تصغير الخط Line size reduced */
            color: #666;
        }
        
        .axis-number {
            font-weight: bold; /* جعل الرقم غامقًا Make the number bold */
        }
        
        /* الكروت الإحصائية المتحركة Animated Statistics Cards */
        .stats-container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 25px;
            position: relative;
        }
        
        .stat-card {
            flex: 1;
            min-width: 200px;
            margin: 8px;
            padding: 18px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
            text-align: center;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0px); }
        }
        
        .stat-card.red { background-color: var(--red-light); border-top: 5px solid var(--danger-color); }
        .stat-card.yellow { background-color: #fff9e6; border-top: 5px solid var(--warning-color); }
        .stat-card.green { background-color: #e8f7ef; border-top: 5px solid var(--success-color); }
        .stat-card.gold { background-color: #fffce6; border-top: 5px solid var(--gold-color); }
        
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        /* نموذج التقييم Evaluation Form */
        .evaluation-form {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .section-title {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0 12px;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-number {
            background-color: white;
            color: var(--primary-color);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 16px;
        }
        
        .criteria-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 13px;
        }
        
        .criteria-table th {
            background-color: var(--light-bg);
            padding: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
            font-size: 13px;
        }
        
        .criteria-table td {
            padding: 10px;
            border: 1px solid var(--border-color);
            text-align: center;
            vertical-align: middle;
        }
        
        .criteria-number {
            text-align: center;
            width: 50px;
            font-weight: bold;
        }
        
        .criteria-name {
            width: 30%;
            text-align: right;
            font-size: 14px;
            font-weight: bold;
        }
        
        .max-score {
            text-align: center;
            width: 80px;
        }
        
        .achieved-score {
            text-align: center;
            width: 120px;
        }
        
        .notes {
            width: 20%;
        }
        
        .not-available {
            width: 100px;
            text-align: center;
        }
        
        .score-btn {
            width: 80px;
            height: 50px;
            padding: 0;
            border: 2px solid var(--secondary-color);
            border-radius: 8px;
            background-color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto;
        }
        
        .score-btn:hover {
            background-color: #f0f8ff;
            transform: scale(1.05);
        }
        
        .score-btn.active {
            background-color: var(--secondary-color);
            color: white;
        }
        
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 13px;
        }
        
        /* نتائج التقييم Evaluation Results */
        .results-summary {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .results-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-color);
            font-size: 22px !important;
            font-weight: bold;
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .results-table th {
            background-color: var(--secondary-color);
            color: white;
            padding: 14px;
            text-align: center;
            font-size: 15px;
        }
        
        .results-table td {
            padding: 12px;
            border: 1px solid var(--border-color);
            text-align: center;
        }
        
        .total-row {
            font-weight: bold;
            background-color: var(--light-bg);
            font-size: 16px;
        }
        
        .percentage-cell {
            font-weight: bold;
            border-radius: 4px;
            color: black !important;
        }
        
        .final-evaluation-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto;
            border: 3px solid #ddd;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 18px;
            color: white;
        }
        
        /* أزرار التحكم Control Buttons */
        .control-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #8B0000;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #e67e22;
        }

        /* توقيع المطور Developer Signature */
        .signature-card {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(135deg, #FF6E00, #2196F3);
            color: white;
            padding: 10.5px 17.5px;
            border-radius: 8.5px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 1000;
            animation: float 6s ease-in-out infinite;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .signature-card:hover { 
            transform: scale(1.05); 
            box-shadow: 0 12px 35px rgba(0,0,0,0.4); 
        }

        @keyframes float { 
            0% { transform: translateY(0px); } 
            50% { transform: translateY(-15px); } 
            100% { transform: translateY(0px); } 
        }

        .signature-card::before {
            content: '';
            position: absolute;
            top: -2px; left: -2px; right: -2px; bottom: -2px;
            background: linear-gradient(135deg, #80EF80, #2196F3);
            border-radius: 14px;
            z-index: -1;
            animation: borderGlow 3s linear infinite;
            background-size: 400%;
        }

        @keyframes borderGlow { 
            0% { background-position: 0% 50%; } 
            50% { background-position: 100% 50%; } 
            100% { background-position: 0% 50%; } 
        }

        .signature-card .name { 
            font-size: 0.95rem; 
            font-weight: 700; 
            margin-bottom: 5px; 
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3); 
        }

        .signature-card .title { 
            font-size: 0.7rem; 
            opacity: 0.9; 
            font-weight: 500; 
        }

        @media (max-width: 768px) { 
            .signature-card { 
                position: relative; 
                bottom: auto; 
                left: auto; 
                margin: 20px auto 0; 
                width: fit-content; 
                animation: none; 
            } 
            .signature-card:hover { 
                transform: none; 
            } 
        }

        @media print {
            .signature-card {
                display: none;
            }
        }
        
        /* تصميم الطباعة Print Design */
        @media print {
            body {
                font-size: 80%;
                transform: scale(0.9);
                transform-origin: top center;
            }
            
            .stats-container,
            .control-buttons,
            .diagram-section,
            .restaurant-selector .restaurant-details,
            .language-toggle {
                display: none;
            }
            
            .evaluation-form,
            .results-summary {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            
            .restaurant-selector {
                border: 1px solid #ddd;
                box-shadow: none;
            }
            
            .header {
                box-shadow: none;
                border-bottom: 2px solid var(--gold-color);
            }
        }
        
        /* تصميم متجاوب Responsive Design */
        @media (max-width: 1024px) {
            .diagram-container {
                height: 400px;
            }
            
            .center-circle {
                width: 75px; /* تعديل للحفاظ على التناسب Adjusted to maintain proportion */
                height: 75px;
            }
            
            .center-text {
                font-size: 9px; /* أصغر للشاشات المتوسطة Smaller for medium screens */
            }
            
            .axis-box {
                width: 160px;
                height: 100px;
            }
            
            .axis-title {
                font-size: 11px; /* أصغر للشاشات المتوسطة Smaller for medium screens */
            }
            
            .axis-score {
                font-size: 16px; /* أصغر للشاشات المتوسطة Smaller for medium screens */
            }
            
            .axis-total {
                font-size: 12px; /* أصغر للشاشات المتوسطة Smaller for medium screens */
            }
        }
        
        @media (max-width: 768px) {
            .diagram-container {
                height: 350px;
            }
            
            .center-circle {
                width: 65px; /* تعديل للحفاظ على التناسب Adjusted to maintain proportion */
                height: 65px;
            }
            
            .center-text {
                font-size: 8px; /* أصغر للشاشات الصغيرة Smaller for small screens */
            }
            
            .axis-box {
                width: 140px;
                height: 90px;
                padding: 8px;
            }
            
            .axis-title {
                font-size: 10px; /* أصغر للشاشات الصغيرة Smaller for small screens */
            }
            
            .axis-score {
                font-size: 14px; /* أصغر للشاشات الصغيرة Smaller for small screens */
            }
            
            .axis-total {
                font-size: 10px; /* أصغر للشاشات الصغيرة Smaller for small screens */
            }
            
            .stats-container {
                flex-direction: column;
            }
            
            .criteria-table {
                font-size: 12px;
                display: block;
                overflow-x: auto;
            }
            
            .criteria-table th,
            .criteria-table td {
                padding: 6px;
            }
            
            .criteria-name {
                font-size: 13px;
            }
            
            .score-btn {
                width: 70px;
                height: 45px;
                font-size: 16px;
            }
            
            .control-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                margin-bottom: 10px;
            }
            
            .restaurant-selector {
                flex-direction: column;
            }
            
            .restaurant-details {
                padding-right: 0;
                margin-top: 15px;
            }
            
            .language-toggle {
                position: relative;
                top: auto;
                left: auto;
                margin-bottom: 15px;
                text-align: center;
            }
        }
        
        @media (max-width: 480px) {
            .diagram-container {
                height: 300px;
            }
            
            .center-circle {
                width: 55px; /* تعديل للحفاظ على التناسب Adjusted to maintain proportion */
                height: 55px;
            }
            
            .center-text {
                font-size: 7px; /* أصغر للشاشات الصغيرة جداً Smaller for very small screens */
            }
            
            .axis-box {
                width: 120px;
                height: 80px;
            }
            
            .axis-title {
                font-size: 9px; /* أصغر للشاشات الصغيرة جداً Smaller for very small screens */
            }
            
            .axis-score {
                font-size: 12px; /* أصغر للشاشات الصغيرة جداً Smaller for very small screens */
            }
            
            .axis-total {
                font-size: 9px; /* أصغر للشاشات الصغيرة جداً Smaller for very small screens */
            }
        }
        
        /* تصميم للغة الإنجليزية English Language Design */
        body[dir="ltr"] {
            text-align: left;
        }
        
        body[dir="ltr"] .criteria-name {
            text-align: left;
        }
        
        body[dir="ltr"] .restaurant-details {
            padding-right: 0;
            padding-left: 20px;
        }
        
        body[dir="ltr"] .signature-card {
            left: auto;
            right: 20px;
        }
        
        body[dir="ltr"] .center-text {
            font-size: 9px; /* أصغر للغة الإنجليزية Slightly smaller for English */
        }
        
        @media (max-width: 768px) {
            body[dir="ltr"] .signature-card {
                right: auto;
                left: auto;
                margin: 20px auto 0;
            }
        }
    </style>
</head>
<body>
    <!-- رأس الصفحة Page Header -->
    <div class="header">
        <!-- زر تبديل اللغة Language Toggle Button -->
        <div class="language-toggle">
            <button class="lang-btn" id="language-toggle">English / English</button>
        </div>
        
        <div class="container">
            <div class="logo-container">
                <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" alt="شعار شركة نايف للأغذية Naif Food Company Logo" class="logo">
            </div>
            <h1 data-translate="title">نموذج تقييم المطعم</h1>
            <p data-translate="subtitle">شركة نايف للأغذية | نظام التقييم الشامل (1250 درجة كحد أقصى)</p>
        </div>
    </div>

    <div class="container">
        <!-- اختيار المطعم Restaurant Selection -->
        <div class="restaurant-selector">
            <div class="restaurant-info">
                <label for="restaurant-search" data-translate="selectRestaurant"><strong>اختر المطعم:</strong></label>
                <div class="restaurant-search-container">
                    <input type="text" id="restaurant-search" data-translate-placeholder="searchPlaceholder" placeholder="ابحث عن المطعم..." autocomplete="off">
                    <div class="restaurant-dropdown" id="restaurant-dropdown"></div>
                </div>
                <input type="hidden" id="selected-restaurant" value="">
            </div>
            <div class="restaurant-details">
                <p><strong data-translate="areaManager">مدير المنطقة:</strong> <span id="area-manager">-</span></p>
                <p><strong data-translate="operationManager">مدير التشغيل:</strong> <span id="operation-manager">-</span></p>
            </div>
            <div class="evaluator-input">
                <label for="evaluator-name" data-translate="evaluator"><strong>القائم بعملية التقييم:</strong></label>
                <input type="text" id="evaluator-name" data-translate-placeholder="evaluatorPlaceholder" placeholder="اسم المقيم">
            </div>
        </div>

        <!-- مخطط الدائرة المركزية Central Diagram -->
        <div class="diagram-section" id="excellence-diagram">
            <h3 class="diagram-title" data-translate="diagramTitle">العناصر الأساسية للتميز</h3>
            <div class="diagram-container">
                <!-- الخطوط الواصلة Connecting Lines -->
                <div class="connecting-line" id="line1"></div>
                <div class="connecting-line" id="line2"></div>
                <div class="connecting-line" id="line3"></div>
                <div class="connecting-line" id="line4"></div>
                
                <!-- الدائرة المركزية Center Circle -->
                <div class="center-circle">
                    <div class="center-text" data-translate="centerText">
                        الهدف:<br>الجودة المطلقة
                    </div>
                </div>
                
                <!-- المربعات المحيطة Surrounding Boxes -->
                <div class="axis-box top-left" id="service-box">
                    <div class="axis-title" data-translate="serviceTitle">خدمة العملاء</div>
                    <div class="axis-score">0</div>
                    <div class="axis-total">من <span class="axis-number">200</span></div>
                </div>
                
                <div class="axis-box top-right" id="cleanliness-box">
                    <div class="axis-title" data-translate="cleanlinessTitle">النظافة</div>
                    <div class="axis-score">0</div>
                    <div class="axis-total">من <span class="axis-number">300</span></div>
                </div>
                
                <div class="axis-box bottom-left" id="equipment-box">
                    <div class="axis-title" data-translate="equipmentTitle">تجهيزات المطعم</div>
                    <div class="axis-score">0</div>
                    <div class="axis-total">من <span class="axis-number">250</span></div>
                </div>
                
                <div class="axis-box bottom-right" id="management-box">
                    <div class="axis-title" data-translate="managementTitle">إدارة المطعم</div>
                    <div class="axis-score">0</div>
                    <div class="axis-total">من <span class="axis-number">250</span></div>
                </div>
            </div>
        </div>

        <!-- الكروت الإحصائية المتحركة Animated Statistics Cards -->
        <div class="stats-container">
            <div class="stat-card floating red">
                <div class="stat-value" id="total-score">0</div>
                <div class="stat-label" data-translate="totalAchieved">إجمالي الدرجات المحققة</div>
            </div>
            <div class="stat-card floating yellow">
                <div class="stat-value" id="total-percentage">0%</div>
                <div class="stat-label" data-translate="totalPercentage">النسبة المئوية الإجمالية</div>
            </div>
            <div class="stat-card floating green">
                <div class="stat-value" id="quality-score">250</div>
                <div class="stat-label" data-translate="qualityRemaining">درجة الجودة (متبقي)</div>
            </div>
            <div class="stat-card floating gold">
                <div class="stat-value" id="final-grade">-</div>
                <div class="stat-label" data-translate="finalEvaluation">التقييم النهائي</div>
            </div>
        </div>

        <!-- نموذج التقييم Evaluation Form -->
        <div class="evaluation-form">
            <h2 style="text-align: center; margin-bottom: 15px; color: var(--primary-color); font-size: 20px;" data-translate="formTitle">نموذج تقييم المطعم (1250 درجة كحد أقصى)</h2>
            
            <!-- محور 1: خدمة العملاء Axis 1: Customer Service -->
            <div class="section-title">
                <span data-translate="serviceSection">1. خدمة العملاء</span>
                <div class="section-number">200</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%" data-translate="number">الرقم</th>
                        <th width="30%" data-translate="mainCriterion">المحور الرئيسي</th>
                        <th width="8%" data-translate="maxScore">الدرجة القصوى</th>
                        <th width="12%" data-translate="achievedScore">الدرجة المحققة</th>
                        <th width="10%" data-translate="notAvailable">غير متوفر</th>
                        <th width="35%" data-translate="notes">الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="service-criteria">
                    <!-- سيتم ملؤها بواسطة JavaScript Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- محور 2: النظافة Axis 2: Cleanliness -->
            <div class="section-title">
                <span data-translate="cleanlinessSection">2. النظافة</span>
                <div class="section-number">300</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%" data-translate="number">الرقم</th>
                        <th width="30%" data-translate="mainCriterion">المحور الرئيسي</th>
                        <th width="8%" data-translate="maxScore">الدرجة القصوى</th>
                        <th width="12%" data-translate="achievedScore">الدرجة المحققة</th>
                        <th width="10%" data-translate="notAvailable">غير متوفر</th>
                        <th width="35%" data-translate="notes">الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="cleanliness-criteria">
                    <!-- سيتم ملؤها بواسطة JavaScript Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- محور 3: المعدات والتجهيزات Axis 3: Equipment and Facilities -->
            <div class="section-title">
                <span data-translate="equipmentSection">3. المعدات والتجهيزات</span>
                <div class="section-number">250</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%" data-translate="number">الرقم</th>
                        <th width="30%" data-translate="mainCriterion">المحور الرئيسي</th>
                        <th width="8%" data-translate="maxScore">الدرجة القصوى</th>
                        <th width="12%" data-translate="achievedScore">الدرجة المحققة</th>
                        <th width="10%" data-translate="notAvailable">غير متوفر</th>
                        <th width="35%" data-translate="notes">الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="equipment-criteria">
                    <!-- سيتم ملؤها بواسطة JavaScript Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- محور 4: إدارة المطعم Axis 4: Restaurant Management -->
            <div class="section-title">
                <span data-translate="managementSection">4. إدارة المطعم</span>
                <div class="section-number">250</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%" data-translate="number">الرقم</th>
                        <th width="30%" data-translate="mainCriterion">المحور الرئيسي</th>
                        <th width="8%" data-translate="maxScore">الدرجة القصوى</th>
                        <th width="12%" data-translate="achievedScore">الدرجة المحققة</th>
                        <th width="10%" data-translate="notAvailable">غير متوفر</th>
                        <th width="35%" data-translate="notes">الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="management-criteria">
                    <!-- سيتم ملؤها بواسطة JavaScript Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- محور 5: الجودة Axis 5: Quality -->
            <div class="section-title">
                <span data-translate="qualitySection">5. الجودة</span>
                <div class="section-number">250</div>
            </div>
            
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th width="5%" data-translate="number">الرقم</th>
                        <th width="30%" data-translate="mainCriterion">المحور الرئيسي</th>
                        <th width="8%" data-translate="maxScore">الدرجة القصوى</th>
                        <th width="12%" data-translate="achievedScore">الدرجة المحققة</th>
                        <th width="10%" data-translate="notAvailable">غير متوفر</th>
                        <th width="35%" data-translate="notes">الملاحظات</th>
                    </tr>
                </thead>
                <tbody id="quality-criteria">
                    <!-- سيتم ملؤها بواسطة JavaScript Will be filled by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- نتائج التقييم Evaluation Results -->
        <div class="results-summary">
            <h2 class="results-title" data-translate="resultsTitle">ملخص نتائج التقييم</h2>
            <p style="text-align: center; color: #666; margin-bottom: 10px; font-size: 14px;" data-translate="resultsNote">(المجموع الكلي يعتمد على العناصر المتاحة فقط)</p>
            
            <table class="results-table">
                <thead>
                    <tr>
                        <th data-translate="axisColumn">المحور</th>
                        <th data-translate="maxScoreColumn">الدرجة القصوى</th>
                        <th data-translate="achievedScoreColumn">الدرجة المحققة</th>
                        <th data-translate="percentageColumn">النسبة %</th>
                        <th data-translate="circleColumn">الدائرة</th>
                    </tr>
                </thead>
                <tbody id="results-body">
                    <!-- سيتم ملؤها بواسطة JavaScript Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <div style="margin-top: 25px; text-align: center;">
                <h3 id="final-evaluation" style="padding: 15px; border-radius: 5px; background-color: #f8f9fa; font-size: 18px;">
                    <span data-translate="totalPoints">إجمالي الدرجات:</span> <span id="total-score-result">0</span> <span data-translate="from">من</span> <span id="total-max-result">1250</span> <span data-translate="points">درجة</span>
                </h3>
                <div style="margin-top: 15px; font-size: 17px;">
                    <strong data-translate="finalEvalLabel">التقييم النهائي:</strong> <span id="evaluation-text" data-translate="notEvaluated">لم يتم التقييم بعد</span>
                </div>
                <div id="final-circle" class="final-evaluation-circle" style="margin-top: 15px;">
                    -
                </div>
            </div>
        </div>

        <!-- أزرار التحكم Control Buttons -->
        <div class="control-buttons">
            <button class="btn btn-primary" onclick="calculateResults()" data-translate="calculateBtn">حساب النتائج</button>
            <button class="btn btn-success" onclick="saveAsPDF()" data-translate="savePDFBtn">حفظ كملف PDF</button>
            <button class="btn btn-warning" onclick="printEvaluation()" data-translate="printBtn">طباعة التقرير</button>
            <button class="btn btn-primary" onclick="resetForm()" data-translate="resetBtn">إعادة تعيين</button>
        </div>
    </div>

    <!-- توقيع المطور Developer Signature -->
    <div class="signature-card">
        <div class="name">Yasser Elkhateeb</div>
        <div class="title">مطور البرنامج 67011143 | Program Developer 67011143</div>
    </div>

    <!-- قالب PDF مخفي Hidden PDF Template -->
    <div id="pdf-template" style="position: absolute; left: -10000px; top: -10000px; width: 794px; height: 1123px; background: white; padding: 20px; box-sizing: border-box; font-family: 'Times New Roman', serif; font-size: 12px; direction: rtl;">
        <div style="text-align: center; margin-bottom: 15px;">
            <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" alt="شعار الشركة Company Logo" style="width: 70px; height: 70px; border-radius: 50%; border: 2px solid #8B0000; margin-bottom: 10px;">
            <h2 style="color: #8B0000; margin: 0; font-size: 24px; font-weight: bold;">شركة نايف للأغذية Naif Food Company</h2>
            <h3 style="color: #8B0000; margin: 10px 0 15px 0; font-size: 20px; font-weight: bold;">نموذج تقييم المطعم Restaurant Evaluation Form</h3>
            <div style="margin-bottom: 10px; font-size: 16px; font-weight: bold;">
                <div data-translate="pdfRestaurant">المطعم: Restaurant:</div>
                <div data-translate="pdfDate">تاريخ التقييم: Evaluation Date:</div>
                <div data-translate="pdfEvaluator">القائم بالتقييم: Evaluator:</div>
                <div data-translate="pdfManagers">مدير المنطقة: Area Manager: | مدير التشغيل: Operation Manager:</div>
            </div>
        </div>
        
        <!-- مخطط العناصر الأساسية للتميز في PDF Excellence Elements Diagram in PDF -->
        <div style="margin: 15px 0; text-align: center; border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
            <h4 style="color: #8B0000; margin: 0 0 10px 0; font-size: 16px; font-weight: bold;" data-translate="pdfDiagramTitle">العناصر الأساسية للتميز Core Elements of Excellence</h4>
            <div id="pdf-diagram" style="position: relative; width: 100%; height: 200px; margin: 0 auto;">
                <!-- سيتم إضافة المخطط هنا Diagram will be added here -->
            </div>
        </div>
        
        <div style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 4px; font-size: 13px;">
            <h4 style="color: #8B0000; margin: 0 0 8px 0; text-align: center; font-size: 16px;" data-translate="pdfSummary">ملخص النتائج Results Summary</h4>
            <div id="pdf-summary" style="text-align: center;"></div>
        </div>
        
        <table style="font-size: 10px; border-collapse: collapse; width: 100%; margin-bottom: 15px;">
            <thead>
                <tr>
                    <th style="padding: 8px; border: 1px solid #000; text-align: center; background: #8B0000; color: white;" data-translate="pdfAxisColumn">المحور Axis</th>
                    <th style="padding: 8px; border: 1px solid #000; text-align: center; background: #8B0000; color: white;" data-translate="pdfMaxScoreColumn">الدرجة القصوى Max Score</th>
                    <th style="padding: 8px; border: 1px solid #000; text-align: center; background: #8B0000; color: white;" data-translate="pdfAchievedScoreColumn">الدرجة المحققة Achieved Score</th>
                    <th style="padding: 8px; border: 1px solid #000; text-align: center; background: #8B0000; color: white;" data-translate="pdfPercentageColumn">النسبة % Percentage</th>
                </tr>
            </thead>
            <tbody id="pdf-results-body">
            </tbody>
        </table>
        
        <div style="margin-top: 15px; padding: 10px; border-top: 2px solid #8B0000; font-size: 13px;">
            <h4 style="color: #8B0000; margin: 0 0 8px 0; text-align: center; font-size: 16px;" data-translate="pdfFinalEval">التقييم النهائي Final Evaluation</h4>
            <div id="pdf-final-evaluation" style="text-align: center; font-size: 15px; font-weight: bold;"></div>
            <!-- إضافة الدائرة الملونة للتقييم النهائي في PDF Add colored circle for final evaluation in PDF -->
            <div id="pdf-final-circle" style="width: 60px; height: 60px; border-radius: 50%; margin: 10px auto; display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 18px; color: white;">
                -
            </div>
        </div>
    </div>

    <script>
        // بيانات اللغة Language Data
        const translations = {
            ar: {
                title: "نموذج تقييم المطعم",
                subtitle: "شركة نايف للأغذية | نظام التقييم الشامل (1250 درجة كحد أقصى)",
                selectRestaurant: "اختر المطعم:",
                searchPlaceholder: "ابحث عن المطعم...",
                areaManager: "مدير المنطقة:",
                operationManager: "مدير التشغيل:",
                evaluator: "القائم بعملية التقييم:",
                evaluatorPlaceholder: "اسم المقيم",
                diagramTitle: "العناصر الأساسية للتميز",
                centerText: "الهدف:<br>الجودة المطلقة",
                serviceTitle: "خدمة العملاء",
                cleanlinessTitle: "النظافة",
                equipmentTitle: "تجهيزات المطعم",
                managementTitle: "إدارة المطعم",
                totalAchieved: "إجمالي الدرجات المحققة",
                totalPercentage: "النسبة المئوية الإجمالية",
                qualityRemaining: "درجة الجودة (متبقي)",
                finalEvaluation: "التقييم النهائي",
                formTitle: "نموذج تقييم المطعم (1250 درجة كحد أقصى)",
                serviceSection: "1. خدمة العملاء",
                cleanlinessSection: "2. النظافة",
                equipmentSection: "3. المعدات والتجهيزات",
                managementSection: "4. إدارة المطعم",
                qualitySection: "5. الجودة",
                number: "الرقم",
                mainCriterion: "المحور الرئيسي",
                maxScore: "الدرجة القصوى",
                achievedScore: "الدرجة المحققة",
                notAvailable: "غير متوفر",
                notes: "الملاحظات",
                resultsTitle: "ملخص نتائج التقييم",
                resultsNote: "(المجموع الكلي يعتمد على العناصر المتاحة فقط)",
                axisColumn: "المحور",
                maxScoreColumn: "الدرجة القصوى",
                achievedScoreColumn: "الدرجة المحققة",
                percentageColumn: "النسبة %",
                circleColumn: "الدائرة",
                totalPoints: "إجمالي الدرجات:",
                from: "من",
                points: "درجة",
                finalEvalLabel: "التقييم النهائي:",
                notEvaluated: "لم يتم التقييم بعد",
                calculateBtn: "حساب النتائج",
                savePDFBtn: "حفظ كملف PDF",
                printBtn: "طباعة التقرير",
                resetBtn: "إعادة تعيين",
                pdfRestaurant: "المطعم:",
                pdfDate: "تاريخ التقييم:",
                pdfEvaluator: "القائم بالتقييم:",
                pdfManagers: "مدير المنطقة: | مدير التشغيل:",
                pdfDiagramTitle: "العناصر الأساسية للتميز",
                pdfSummary: "ملخص النتائج",
                pdfAxisColumn: "المحور",
                pdfMaxScoreColumn: "الدرجة القصوى",
                pdfAchievedScoreColumn: "الدرجة المحققة",
                pdfPercentageColumn: "النسبة %",
                pdfFinalEval: "التقييم النهائي"
            },
            en: {
                title: "Restaurant Evaluation Form",
                subtitle: "Naif Food Company | Comprehensive Evaluation System (1250 points maximum)",
                selectRestaurant: "Select Restaurant:",
                searchPlaceholder: "Search for restaurant...",
                areaManager: "Area Manager:",
                operationManager: "Operation Manager:",
                evaluator: "Evaluator:",
                evaluatorPlaceholder: "Evaluator Name",
                diagramTitle: "Core Elements of Excellence",
                centerText: "Goal:<br>Absolute Quality",
                serviceTitle: "Customer Service",
                cleanlinessTitle: "Cleanliness",
                equipmentTitle: "Restaurant Equipment",
                managementTitle: "Restaurant Management",
                totalAchieved: "Total Achieved Points",
                totalPercentage: "Total Percentage",
                qualityRemaining: "Quality Score (Remaining)",
                finalEvaluation: "Final Evaluation",
                formTitle: "Restaurant Evaluation Form (1250 points maximum)",
                serviceSection: "1. Customer Service",
                cleanlinessSection: "2. Cleanliness",
                equipmentSection: "3. Equipment and Facilities",
                managementSection: "4. Restaurant Management",
                qualitySection: "5. Quality",
                number: "Number",
                mainCriterion: "Main Criterion",
                maxScore: "Max Score",
                achievedScore: "Achieved Score",
                notAvailable: "Not Available",
                notes: "Notes",
                resultsTitle: "Evaluation Results Summary",
                resultsNote: "(Total is based on available items only)",
                axisColumn: "Axis",
                maxScoreColumn: "Max Score",
                achievedScoreColumn: "Achieved Score",
                percentageColumn: "Percentage %",
                circleColumn: "Circle",
                totalPoints: "Total Points:",
                from: "from",
                points: "points",
                finalEvalLabel: "Final Evaluation:",
                notEvaluated: "Not Evaluated Yet",
                calculateBtn: "Calculate Results",
                savePDFBtn: "Save as PDF",
                printBtn: "Print Report",
                resetBtn: "Reset",
                pdfRestaurant: "Restaurant:",
                pdfDate: "Evaluation Date:",
                pdfEvaluator: "Evaluator:",
                pdfManagers: "Area Manager: | Operation Manager:",
                pdfDiagramTitle: "Core Elements of Excellence",
                pdfSummary: "Results Summary",
                pdfAxisColumn: "Axis",
                pdfMaxScoreColumn: "Max Score",
                pdfAchievedScoreColumn: "Achieved Score",
                pdfPercentageColumn: "Percentage %",
                pdfFinalEval: "Final Evaluation"
            }
        };

        // بيانات المطاعم Restaurants Data
        const restaurantsData = [
            { name: "الفيحاء", areaManager: "حجازي", operationManager: "طارق بيومي" },
            { name: "شارع البحرين", areaManager: "مختار", operationManager: "هاني عبدالله" },
            { name: "جمعية العدان والقصور", areaManager: "انور", operationManager: "طارق بيومي" },
            { name: "الجابرية تكا و فرايد", areaManager: "مختار", operationManager: "هاني عبدالله" },
            { name: "الفحاحيل", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "أبو حليفة", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "الرقعي", areaManager: "عماد", operationManager: "طارق بيومي" },
            { name: "مشرف", areaManager: "مختار", operationManager: "هاني عبدالله" },
            { name: "النافورة", areaManager: "مختار", operationManager: "هاني عبدالله" },
            { name: "القادسية", areaManager: "حجازي", operationManager: "طارق بيومي" },
            { name: "صباح السالم", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "الضباعية", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "الشرق", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "الجابرية بنت الديك", areaManager: "مختار", operationManager: "هاني عبدالله" },
            { name: "الجهراء الزويخ", areaManager: "طارق", operationManager: "طارق بيومي" },
            { name: "الشويخ واره", areaManager: "حجازي", operationManager: "طارق بيومي" },
            { name: "السيد ياسين", areaManager: "مختار", operationManager: "هاني عبدالله" },
            { name: "الفنطاس", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "السندباد", areaManager: "مختار", operationManager: "هاني عبدالله" },
            { name: "المطار", areaManager: "حجازي", operationManager: "طارق بيومي" },
            { name: "المنقف", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "حولي بارك", areaManager: "حجازي", operationManager: "طارق بيومي" },
            { name: "الرقة", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "الرحاب", areaManager: "عماد", operationManager: "طارق بيومي" },
            { name: "هدية", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "نادي الصليبخات", areaManager: "عماد", operationManager: "طارق بيومي" },
            { name: "الجهراء الصناعية", areaManager: "حجازي", operationManager: "طارق بيومي" },
            { name: "الفروانية", areaManager: "عماد", operationManager: "طارق بيومي" },
            { name: "أسواق القرين", areaManager: "انور", operationManager: "طارق بيومي" },
            { name: "سلوى", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "سوق الجليب", areaManager: "طارق", operationManager: "طارق بيومي" },
            { name: "الشهداء", areaManager: "انور", operationManager: "طارق بيومي" },
            { name: "الدسمة وبنيد القار", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "جمعية صباح الاحمد", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "الافينيوز", areaManager: "طارق", operationManager: "طارق بيومي" },
            { name: "الصليبية الصناعية", areaManager: "طارق", operationManager: "طارق بيومي" },
            { name: "جمعية أبوفطيرة", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "غرب أبو فطيرة", areaManager: "انور", operationManager: "طارق بيومي" },
            { name: "خيطان العصيمي", areaManager: "انور", operationManager: "طارق بيومي" },
            { name: "الوفرة", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "جمعية القيروان", areaManager: "طارق", operationManager: "طارق بيومي" },
            { name: "شرق الاحمدي", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "الفروانية فرع 2", areaManager: "عماد", operationManager: "طارق بيومي" },
            { name: "جمعية الصليبية", areaManager: "طارق", operationManager: "طارق بيومي" },
            { name: "جمعية الزهراء", areaManager: "انور", operationManager: "طارق بيومي" },
            { name: "جمعية مدينة جابر الأحمد", areaManager: "عماد", operationManager: "طارق بيومي" },
            { name: "الخيران أوتليت مول", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "الخيران أويا مول", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "الجهراء ليالي الشرق", areaManager: "حجازي", operationManager: "طارق بيومي" },
            { name: "الجهراء مجمع مكة", areaManager: "طارق", operationManager: "طارق بيومي" },
            { name: "العارضية الجديد", areaManager: "عماد", operationManager: "طارق بيومي" },
            { name: "الري", areaManager: "مختار", operationManager: "هاني عبدالله" },
            { name: "مارينا مول", areaManager: "مختار", operationManager: "هاني عبدالله" },
            { name: "صباح السالم (العرين)", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "مول 360", areaManager: "انور", operationManager: "طارق بيومي" },
            { name: "الخيول", areaManager: "ثروت", operationManager: "هاني عبدالله" },
            { name: "مجمع الكوت", areaManager: "وليد", operationManager: "هاني عبدالله" },
            { name: "كبد", areaManager: "طارق", operationManager: "طارق بيومي" },
            { name: "سعد العبدالله", areaManager: "مختار", operationManager: "هاني عبدالله" }
        ];

        // بيانات نموذج التقييم مع ترجمات Evaluation Form Data with translations
        const evaluationData = {
            service: [
                { id: "1.1", name: { ar: "الزي الموحد", en: "Uniform" }, maxScore: 15 },
                { id: "1.2", name: { ar: "الترحيب بالعملاء", en: "Welcoming Customers" }, maxScore: 25 },
                { id: "1.3", name: { ar: "الاقتراحات", en: "Suggestions" }, maxScore: 20 },
                { id: "1.4", name: { ar: "شكر العميل", en: "Thanking Customer" }, maxScore: 20 },
                { id: "1.5", name: { ar: "وقت الخدمة", en: "Service Time" }, maxScore: 35 },
                { id: "1.6", name: { ar: "طريقة الحديث", en: "Conversation Manner" }, maxScore: 25 },
                { id: "1.7", name: { ar: "توفر النقدية", en: "Cash Availability" }, maxScore: 15 },
                { id: "1.8", name: { ar: "تجهيز الطاولات", en: "Table Setup" }, maxScore: 20 },
                { id: "1.9", name: { ar: "تكرار الطلب", en: "Order Repetition" }, maxScore: 15 },
                { id: "1.10", name: { ar: "إصدار الفاتورة", en: "Invoice Issuance" }, maxScore: 10 }
            ],
            cleanliness: [
                { id: "2.1", name: { ar: "اللافتات الخارجية", en: "External Signage" }, maxScore: 25 },
                { id: "2.2", name: { ar: "الأبواب والنوافذ", en: "Doors and Windows" }, maxScore: 30 },
                { id: "2.3", name: { ar: "حاويات القمامة", en: "Trash Containers" }, maxScore: 35 },
                { id: "2.4", name: { ar: "الصالة/الأرضية/الجدران", en: "Hall/Floor/Walls" }, maxScore: 40 },
                { id: "2.5", name: { ar: "الطاولات والكراسي والديكور", en: "Tables, Chairs and Decor" }, maxScore: 35 },
                { id: "2.6", name: { ar: "القمامة/مبيد الحشرات", en: "Trash/Pesticides" }, maxScore: 30 },
                { id: "2.7", name: { ar: "الحمامات", en: "Bathrooms" }, maxScore: 40 },
                { id: "2.8", name: { ar: "قائمة الأسعار/الكاونتر", en: "Price List/Counter" }, maxScore: 20 },
                { id: "2.9", name: { ar: "الثلاجات والبرادات", en: "Refrigerators and Coolers" }, maxScore: 25 },
                { id: "2.10", name: { ar: "المطبخ/المغاسل", en: "Kitchen/Sinks" }, maxScore: 20 }
            ],
            equipment: [
                { id: "3.1", name: { ar: "الشاورما/الشواية", en: "Shawarma/Grill" }, maxScore: 30 },
                { id: "3.2", name: { ar: "المخزن", en: "Storage" }, maxScore: 25 },
                { id: "3.3", name: { ar: "الشواية", en: "Grill" }, maxScore: 35 },
                { id: "3.4", name: { ar: "ثلاجة المشروبات/ماكينة بيبسي", en: "Beverage Refrigerator/Pepsi Machine" }, maxScore: 30 },
                { id: "3.5", name: { ar: "الميكروويف", en: "Microwave" }, maxScore: 20 },
                { id: "3.6", name: { ar: "الشفاطات/الفلاتر", en: "Hoods/Filters" }, maxScore: 35 },
                { id: "3.7", name: { ar: "سيارات التوصيل", en: "Delivery Vehicles" }, maxScore: 25 },
                { id: "3.8", name: { ar: "خبز التوست والأرز", en: "Toast Bread and Rice" }, maxScore: 20 },
                { id: "3.9", name: { ar: "طاولة التحضير والتقطيع", en: "Preparation and Cutting Table" }, maxScore: 20 },
                { id: "3.10", name: { ar: "الديسبليه يعمل جيداً", en: "Display Works Well" }, maxScore: 10 }
            ],
            management: [
                { id: "4.1", name: { ar: "المحاسب/الكاشير", en: "Accountant/Cashier" }, maxScore: 30 },
                { id: "4.2", name: { ar: "فلاتر المياه", en: "Water Filters" }, maxScore: 35 },
                { id: "4.3", name: { ar: "المنهول", en: "Manhole" }, maxScore: 15 },
                { id: "4.4", name: { ar: "المكيف", en: "Air Conditioner" }, maxScore: 40 },
                { id: "4.5", name: { ar: "شاشة العرض", en: "Display Screen" }, maxScore: 20 },
                { id: "4.6", name: { ar: "رخصة المطعم", en: "Restaurant License" }, maxScore: 30 },
                { id: "4.7", name: { ar: "كروت الصحة", en: "Health Cards" }, maxScore: 30 },
                { id: "4.8", name: { ar: "تقرير المطعم", en: "Restaurant Report" }, maxScore: 20 },
                { id: "4.9", name: { ar: "حضور الموظفين", en: "Staff Attendance" }, maxScore: 20 },
                { id: "4.10", name: { ar: "درجة حرارة الثلاجة", en: "Refrigerator Temperature" }, maxScore: 10 }
            ],
            quality: [
                { id: "5.1", name: { ar: "جودة الخبز", en: "Bread Quality" }, maxScore: 25 },
                { id: "5.2", name: { ar: "جودة الدجاج", en: "Chicken Quality" }, maxScore: 30 },
                { id: "5.3", name: { ar: "جودة الخضروات", en: "Vegetable Quality" }, maxScore: 25 },
                { id: "5.4", name: { ar: "جودة/كمية السلطات", en: "Salad Quality/Quantity" }, maxScore: 20 },
                { id: "5.5", name: { ar: "كمية الطعام", en: "Food Quantity" }, maxScore: 25 },
                { id: "5.6", name: { ar: "استخدام اللف والحزم", en: "Using Wrapping and Packing" }, maxScore: 15 },
                { id: "5.7", name: { ar: "توقيت الطهي", en: "Cooking Timing" }, maxScore: 20 },
                { id: "5.8", name: { ar: "جودة الخلط", en: "Mixing Quality" }, maxScore: 20 },
                { id: "5.9", name: { ar: "أوراق المطعم", en: "Restaurant Papers" }, maxScore: 15 },
                { id: "5.10", name: { ar: "وجبات مهدرة", en: "Wasted Meals" }, maxScore: 20 },
                { id: "5.11", name: { ar: "الدخول والخروج", en: "Entry and Exit" }, maxScore: 15 }
            ]
        };

        // تهيئة النموذج Initialize Form
        let currentLang = 'ar';
        let evaluationTexts = {
            ar: {
                red: 'أحمر - يحتاج تدخل فوري',
                yellow: 'أصفر - يحتاج متابعة',
                green: 'أخضر - أداء جيد',
                gold: 'ذهبي - أداء ممتاز'
            },
            en: {
                red: 'Red - Needs Immediate Intervention',
                yellow: 'Yellow - Needs Follow-up',
                green: 'Green - Good Performance',
                gold: 'Golden - Excellent Performance'
            }
        };

        function initializeForm() {
            // تحميل اللغة المحفوظة Load saved language
            const savedLang = localStorage.getItem('preferredLanguage');
            if (savedLang && (savedLang === 'ar' || savedLang === 'en')) {
                currentLang = savedLang;
                if (currentLang === 'en') {
                    document.documentElement.dir = 'ltr';
                }
            }
            
            // تحديث اللغة Update language
            updateLanguage();
            
            // تهيئة البحث الديناميكي عن المطاعم Setup Dynamic Restaurant Search
            setupRestaurantSearch();
            
            // ملء معايير التقييم Fill Evaluation Criteria
            fillCriteriaTable('service-criteria', evaluationData.service);
            fillCriteriaTable('cleanliness-criteria', evaluationData.cleanliness);
            fillCriteriaTable('equipment-criteria', evaluationData.equipment);
            fillCriteriaTable('management-criteria', evaluationData.management);
            fillCriteriaTable('quality-criteria', evaluationData.quality);
            
            // إعداد حدث زر تبديل اللغة Setup language toggle button event
            document.getElementById('language-toggle').addEventListener('click', toggleLanguage);
            
            // إضافة مستمعين للأحداث لحساب النتائج تلقائياً Add Event Listeners for Automatic Results Calculation
            document.querySelectorAll('.score-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    calculateResults();
                });
            });
            
            document.querySelectorAll('.not-available-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const itemId = this.getAttribute('data-id').replace('na-', 'score-');
                    const scoreBtn = document.querySelector(`button[data-id="${itemId}"]`);
                    const hiddenInput = document.getElementById(itemId);
                    
                    if (this.checked) {
                        // إذا تم تحديد "غير متوفر"، ضع الدرجة 0 If "Not Available" is checked, set score to 0
                        scoreBtn.textContent = '0';
                        scoreBtn.classList.remove('active');
                        if (hiddenInput) hiddenInput.value = '0';
                    }
                    calculateResults();
                });
            });
            
            // حساب النتائج الأولية Calculate Initial Results
            calculateResults();
        }

        // تبديل اللغة Toggle Language
        function toggleLanguage() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            document.documentElement.lang = currentLang;
            
            updateLanguage();
            localStorage.setItem('preferredLanguage', currentLang);
        }

        // تحديث اللغة في الصفحة Update Language on Page
        function updateLanguage() {
            // تحديث النصوص Update texts
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[currentLang][key]) {
                    element.innerHTML = translations[currentLang][key];
                }
            });
            
            // تحديث placeholder للنماذج Update placeholder for forms
            document.querySelectorAll('[data-translate-placeholder]').forEach(input => {
                const key = input.getAttribute('data-translate-placeholder');
                if (translations[currentLang][key]) {
                    input.placeholder = translations[currentLang][key];
                }
            });
            
            // تحديث زر تبديل اللغة Update language toggle button
            document.getElementById('language-toggle').textContent = currentLang === 'ar' ? 'English / English' : 'العربية / العربية';
            
            // إعادة ملء جداول المعايير مع الترجمة Refill criteria tables with translation
            refillAllCriteriaTables();
            
            // إعادة حساب النتائج لإعادة تعيين نصوص التقييم Recalculate results to reset evaluation texts
            calculateResults();
        }

        // إعادة ملء جميع جداول المعايير Refill All Criteria Tables
        function refillAllCriteriaTables() {
            fillCriteriaTable('service-criteria', evaluationData.service);
            fillCriteriaTable('cleanliness-criteria', evaluationData.cleanliness);
            fillCriteriaTable('equipment-criteria', evaluationData.equipment);
            fillCriteriaTable('management-criteria', evaluationData.management);
            fillCriteriaTable('quality-criteria', evaluationData.quality);
        }

        // إعداد البحث الديناميكي عن المطاعم Setup Dynamic Restaurant Search
        function setupRestaurantSearch() {
            const searchInput = document.getElementById('restaurant-search');
            const dropdown = document.getElementById('restaurant-dropdown');
            const selectedRestaurantInput = document.getElementById('selected-restaurant');
            
            // ملء القائمة المنسدلة Fill Dropdown
            restaurantsData.forEach(restaurant => {
                const item = document.createElement('div');
                item.className = 'restaurant-dropdown-item';
                item.textContent = restaurant.name;
                item.addEventListener('click', function() {
                    searchInput.value = restaurant.name;
                    selectedRestaurantInput.value = restaurant.name;
                    updateRestaurantDetails();
                    dropdown.style.display = 'none';
                });
                dropdown.appendChild(item);
            });
            
            // البحث الديناميكي Dynamic Search
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const items = dropdown.querySelectorAll('.restaurant-dropdown-item');
                let hasMatches = false;
                
                items.forEach(item => {
                    if (item.textContent.toLowerCase().includes(searchTerm)) {
                        item.style.display = 'block';
                        hasMatches = true;
                    } else {
                        item.style.display = 'none';
                    }
                });
                
                if (searchTerm && hasMatches) {
                    dropdown.style.display = 'block';
                } else {
                    dropdown.style.display = 'none';
                }
                
                // إذا كان النص مطابقاً تماماً لمطعم If text exactly matches a restaurant
                const exactMatch = restaurantsData.find(r => r.name.toLowerCase() === searchTerm);
                if (exactMatch) {
                    selectedRestaurantInput.value = exactMatch.name;
                    updateRestaurantDetails();
                } else if (!searchTerm) {
                    selectedRestaurantInput.value = '';
                    updateRestaurantDetails();
                }
            });
            
            // إغلاق القائمة عند النقر خارجها Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.style.display = 'none';
                }
            });
        }

        // تحديث تفاصيل المطعم Update Restaurant Details
        function updateRestaurantDetails() {
            const selectedRestaurant = document.getElementById('selected-restaurant').value;
            
            if (selectedRestaurant) {
                const restaurant = restaurantsData.find(r => r.name === selectedRestaurant);
                if (restaurant) {
                    document.getElementById('area-manager').textContent = restaurant.areaManager;
                    document.getElementById('operation-manager').textContent = restaurant.operationManager;
                }
            } else {
                document.getElementById('area-manager').textContent = '-';
                document.getElementById('operation-manager').textContent = '-';
            }
        }

        // ملء جدول المعايير Fill Criteria Table
        function fillCriteriaTable(tableId, criteria) {
            const tableBody = document.getElementById(tableId);
            tableBody.innerHTML = '';
            
            criteria.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="criteria-number">${item.id}</td>
                    <td class="criteria-name">${item.name[currentLang]}</td>
                    <td class="max-score">${item.maxScore}</td>
                    <td class="achieved-score">
                        <button type="button" class="score-btn" data-id="score-${item.id}" data-max="${item.maxScore}">0</button>
                        <input type="hidden" id="score-${item.id}" value="0">
                    </td>
                    <td class="not-available">
                        <input type="checkbox" class="not-available-checkbox" data-id="na-${item.id}">
                    </td>
                    <td class="notes">
                        <input type="text" id="notes-${item.id}" placeholder="${translations[currentLang].notes}">
                    </td>
                `;
                tableBody.appendChild(row);
                
                // إضافة حدث النقر على زر الدرجة Add Click Event to Score Button
                const scoreBtn = row.querySelector('.score-btn');
                scoreBtn.addEventListener('click', function() {
                    const notAvailableCheckbox = row.querySelector('.not-available-checkbox');
                    
                    // إذا كان العنصر غير متوفر، لا يمكن تغيير الدرجة If item is not available, cannot change score
                    if (notAvailableCheckbox && notAvailableCheckbox.checked) {
                        alert(currentLang === 'ar' 
                            ? 'لا يمكن تعديل درجة عنصر غير متوفر. يرجى إلغاء تحديد "غير متوفر" أولاً.' 
                            : 'Cannot modify score of unavailable item. Please uncheck "Not Available" first.');
                        return;
                    }
                    
                    const currentScore = parseInt(this.textContent) || 0;
                    const maxScore = parseInt(this.getAttribute('data-max'));
                    const newScore = currentScore === maxScore ? 0 : maxScore;
                    this.textContent = newScore;
                    this.classList.toggle('active', newScore === maxScore);
                    
                    // تحديث الحقل المخفي Update Hidden Field
                    const hiddenInput = document.getElementById(this.getAttribute('data-id'));
                    if (hiddenInput) {
                        hiddenInput.value = newScore;
                    }
                    
                    calculateResults();
                });
            });
        }

        // حساب النتائج Calculate Results
        function calculateResults() {
            let totalAchieved = 0;
            let totalMax = 0;
            const results = [];
            
            // حساب لكل محور Calculate for each axis
            const categories = [
                { id: 'service', name: translations[currentLang].serviceTitle, maxTotal: 200 },
                { id: 'cleanliness', name: translations[currentLang].cleanlinessTitle, maxTotal: 300 },
                { id: 'equipment', name: translations[currentLang].equipmentTitle, maxTotal: 250 },
                { id: 'management', name: translations[currentLang].managementTitle, maxTotal: 250 },
                { id: 'quality', name: translations[currentLang].qualitySection, maxTotal: 250 }
            ];
            
            categories.forEach(category => {
                let achieved = 0;
                let availableMax = 0; // للعناصر المتوفرة فقط For available items only
                
                evaluationData[category.id].forEach(item => {
                    const notAvailableCheckbox = document.querySelector(`input[data-id="na-${item.id}"]`);
                    const isNotAvailable = notAvailableCheckbox && notAvailableCheckbox.checked;
                    
                    if (!isNotAvailable) {
                        availableMax += item.maxScore;
                        
                        const scoreInput = document.getElementById(`score-${item.id}`);
                        const score = parseInt(scoreInput.value) || 0;
                        
                        // التأكد من أن الدرجة المحققة لا تتجاوز الدرجة القصوى Ensure achieved score doesn't exceed max score
                        if (score > item.maxScore) {
                            scoreInput.value = item.maxScore;
                            achieved += item.maxScore;
                        } else {
                            achieved += score;
                        }
                    }
                });
                
                // إذا كانت هناك عناصر غير متوفرة، نعدل الدرجة القصوى If there are unavailable items, adjust max score
                const adjustedMax = availableMax > 0 ? availableMax : 0;
                
                totalAchieved += achieved;
                totalMax += adjustedMax;
                
                const percentage = adjustedMax > 0 ? Math.round((achieved / adjustedMax) * 100) : 0;
                results.push({
                    id: category.id,
                    name: category.name,
                    maxScore: adjustedMax,
                    achievedScore: achieved,
                    percentage: percentage,
                    originalMax: category.maxTotal
                });
                
                // تحديث المربعات في المخطط (للمحاور الأربعة الأولى فقط) Update boxes in diagram (only for first four axes)
                if (category.id !== 'quality') {
                    updateDiagramBox(category.id, achieved, adjustedMax);
                }
            });
            
            // حساب النسبة الإجمالية Calculate Total Percentage
            const totalPercentage = totalMax > 0 ? Math.round((totalAchieved / totalMax) * 100) : 0;
            
            // تحديث الكروت الإحصائية Update Statistics Cards
            updateStatsCards(totalAchieved, totalPercentage, totalMax);
            
            // تحديث جدول النتائج Update Results Table
            updateResultsTable(results, totalAchieved, totalPercentage, totalMax);
            
            // تحديث التقييم النهائي Update Final Evaluation
            updateFinalEvaluation(totalPercentage, totalAchieved, totalMax);
        }

        // تحديث المربعات في المخطط Update Boxes in Diagram
        function updateDiagramBox(categoryId, achieved, max) {
            const boxElement = document.getElementById(`${categoryId}-box`);
            if (boxElement) {
                const scoreElement = boxElement.querySelector('.axis-score');
                const totalElement = boxElement.querySelector('.axis-total');
                
                if (scoreElement) scoreElement.textContent = achieved;
                if (totalElement) totalElement.innerHTML = `${translations[currentLang].from} <span class="axis-number">${max}</span>`;
                
                // تحديث لون المربع بناءً على النسبة Update box color based on percentage
                const percentage = max > 0 ? Math.round((achieved / max) * 100) : 0;
                boxElement.style.borderColor = getPercentageColorForDiagram(percentage);
            }
        }

        // تحديث الكروت الإحصائية Update Statistics Cards
        function updateStatsCards(totalAchieved, totalPercentage, totalMax) {
            document.getElementById('total-score').textContent = totalAchieved;
            document.getElementById('total-percentage').textContent = totalPercentage + '%';
            
            // حساب درجة الجودة (المتبقي) Calculate Quality Score (Remaining)
            const qualityScore = totalMax - totalAchieved;
            document.getElementById('quality-score').textContent = qualityScore;
            
            // تحديث لون الكروت حسب النسبة Update card colors based on percentage
            const statCards = document.querySelectorAll('.stat-card');
            statCards.forEach(card => {
                card.classList.remove('red', 'yellow', 'green', 'gold');
                
                if (totalPercentage < 75) {
                    card.classList.add('red');
                    document.getElementById('final-grade').textContent = currentLang === 'ar' ? '🔴 تدخل' : '🔴 Intervention';
                } else if (totalPercentage >= 75 && totalPercentage < 85) {
                    card.classList.add('yellow');
                    document.getElementById('final-grade').textContent = currentLang === 'ar' ? '🟡 متابعة' : '🟡 Follow-up';
                } else if (totalPercentage >= 85 && totalPercentage < 90) {
                    card.classList.add('green');
                    document.getElementById('final-grade').textContent = currentLang === 'ar' ? '🟢 جيد' : '🟢 Good';
                } else if (totalPercentage >= 90) {
                    card.classList.add('gold');
                    document.getElementById('final-grade').textContent = currentLang === 'ar' ? '🟡✨ ممتاز' : '🟡✨ Excellent';
                }
            });
        }

        // تحديث جدول النتائج Update Results Table
        function updateResultsTable(results, totalAchieved, totalPercentage, totalMax) {
            const resultsBody = document.getElementById('results-body');
            resultsBody.innerHTML = '';
            
            // إضافة صفوف النتائج لكل محور Add result rows for each axis
            results.forEach(result => {
                const row = document.createElement('tr');
                const colorClass = getPercentageColorClass(result.percentage);
                const circleColor = getPercentageColorForCircle(result.percentage);
                
                row.innerHTML = `
                    <td>${result.name}</td>
                    <td>${result.maxScore}</td>
                    <td>${result.achievedScore}</td>
                    <td class="percentage-cell" style="background-color: ${getPercentageColor(result.percentage)};">${result.percentage}%</td>
                    <td>
                        <div class="final-evaluation-circle" style="background-color: ${circleColor}; width: 40px; height: 40px; font-size: 14px;">
                            ${result.percentage}%
                        </div>
                    </td>
                `;
                resultsBody.appendChild(row);
            });
            
            // إضافة صف الإجمالي Add Total Row
            const totalRow = document.createElement('tr');
            totalRow.classList.add('total-row');
            const totalColor = getPercentageColor(totalPercentage);
            const totalCircleColor = getPercentageColorForCircle(totalPercentage);
            
            totalRow.innerHTML = `
                <td><strong>${translations[currentLang].from} 1-5</strong></td>
                <td><strong>${totalMax}</strong></td>
                <td><strong>${totalAchieved}</strong></td>
                <td class="percentage-cell" style="background-color: ${totalColor};"><strong>${totalPercentage}%</strong></td>
                <td>
                    <div class="final-evaluation-circle" style="background-color: ${totalCircleColor}; width: 50px; height: 50px; font-size: 16px;">
                        ${totalPercentage}%
                    </div>
                </td>
            `;
            resultsBody.appendChild(totalRow);
            
            // تحديث نتيجة الإجمالي Update Total Result
            document.getElementById('total-score-result').textContent = totalAchieved;
            document.getElementById('total-max-result').textContent = totalMax;
        }

        // تحديث التقييم النهائي Update Final Evaluation
        function updateFinalEvaluation(percentage, totalAchieved, totalMax) {
            const evaluationText = document.getElementById('evaluation-text');
            const finalEvaluation = document.getElementById('final-evaluation');
            const finalCircle = document.getElementById('final-circle');
            
            let color, text, circleColor;
            
            if (percentage < 75) {
                text = evaluationTexts[currentLang].red;
                color = '#e74c3c';
                circleColor = '#e74c3c';
                finalEvaluation.style.backgroundColor = '#ffeaea';
                finalEvaluation.style.color = '#e74c3c';
            } else if (percentage >= 75 && percentage < 85) {
                text = evaluationTexts[currentLang].yellow;
                color = '#f39c12';
                circleColor = '#f39c12';
                finalEvaluation.style.backgroundColor = '#fff9e6';
                finalEvaluation.style.color = '#f39c12';
            } else if (percentage >= 85 && percentage < 90) {
                text = evaluationTexts[currentLang].green;
                color = '#27ae60';
                circleColor = '#27ae60';
                finalEvaluation.style.backgroundColor = '#e8f7ef';
                finalEvaluation.style.color = '#27ae60';
            } else if (percentage >= 90) {
                text = evaluationTexts[currentLang].gold;
                color = '#b8860b';
                circleColor = '#ffd700';
                finalEvaluation.style.backgroundColor = '#fffce6';
                finalEvaluation.style.color = '#b8860b';
            }
            
            evaluationText.textContent = text;
            evaluationText.style.color = color;
            
            // تحديث الدائرة Update Circle
            if (finalCircle) {
                finalCircle.style.backgroundColor = circleColor;
                finalCircle.textContent = percentage + '%';
                finalCircle.style.color = 'white';
            }
        }

        // الحصول على لون النسبة المئوية Get Percentage Color
        function getPercentageColor(percentage) {
            if (percentage < 75) return '#ffeaea';
            if (percentage >= 75 && percentage < 85) return '#fff9e6';
            if (percentage >= 85 && percentage < 90) return '#e8f7ef';
            return '#fffce6';
        }

        // الحصول على لون النسبة المئوية للمخطط Get Percentage Color for Diagram
        function getPercentageColorForDiagram(percentage) {
            if (percentage < 75) return '#e74c3c';
            if (percentage >= 75 && percentage < 85) return '#f39c12';
            if (percentage >= 85 && percentage < 90) return '#27ae60';
            return '#ffd700';
        }

        // الحصول على لون الدائرة للنسبة المئوية Get Circle Color for Percentage
        function getPercentageColorForCircle(percentage) {
            if (percentage < 75) return '#e74c3c';
            if (percentage >= 75 && percentage < 85) return '#f39c12';
            if (percentage >= 85 && percentage < 90) return '#27ae60';
            return '#ffd700';
        }

        // الحصول على فئة اللون للنسبة المئوية Get Color Class for Percentage
        function getPercentageColorClass(percentage) {
            if (percentage < 75) return 'red';
            if (percentage >= 75 && percentage < 85) return 'yellow';
            if (percentage >= 85 && percentage < 90) return 'green';
            return 'gold';
        }

        // حفظ التقرير كملف PDF Save Report as PDF
        async function saveAsPDF() {
            if (!window.jspdf) {
                alert(currentLang === 'ar' 
                    ? 'مكتبة PDF غير محملة. يرجى التحقق من الاتصال بالإنترنت.' 
                    : 'PDF library not loaded. Please check internet connection.');
                return;
            }
            
            try {
                // حساب النتائج أولاً Calculate results first
                calculateResults();
                
                // تحضير بيانات PDF Prepare PDF data
                const today = new Date();
                const formattedDate = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
                document.getElementById('pdf-date').textContent = formattedDate;
                
                // إضافة اسم المطعم والمعلومات Add restaurant name and information
                const selectedRestaurant = document.getElementById('selected-restaurant').value;
                document.getElementById('pdf-restaurant').textContent = selectedRestaurant || (currentLang === 'ar' ? 'غير محدد' : 'Not Specified');
                
                const restaurant = restaurantsData.find(r => r.name === selectedRestaurant);
                if (restaurant) {
                    document.getElementById('pdf-area-manager').textContent = restaurant.areaManager;
                    document.getElementById('pdf-operation-manager').textContent = restaurant.operationManager;
                } else {
                    document.getElementById('pdf-area-manager').textContent = '-';
                    document.getElementById('pdf-operation-manager').textContent = '-';
                }
                
                document.getElementById('pdf-evaluator').textContent = document.getElementById('evaluator-name').value || (currentLang === 'ar' ? 'غير محدد' : 'Not Specified');
                
                // تحديث نصوص PDF Update PDF texts
                document.querySelectorAll('[data-translate]').forEach(element => {
                    const key = element.getAttribute('data-translate');
                    if (translations[currentLang][key]) {
                        element.textContent = translations[currentLang][key];
                    }
                });
                
                // حساب النتائج الإجمالية Calculate total results
                const totalAchieved = parseInt(document.getElementById('total-score').textContent);
                const totalPercentage = parseInt(document.getElementById('total-percentage').textContent);
                const totalMax = parseInt(document.getElementById('total-max-result').textContent);
                const evaluationText = document.getElementById('evaluation-text').textContent;
                
                document.getElementById('pdf-summary').innerHTML = `
                    <div>${translations[currentLang].totalPoints} <strong>${totalAchieved}</strong> ${translations[currentLang].from} <strong>${totalMax}</strong> ${translations[currentLang].points}</div>
                    <div>${translations[currentLang].totalPercentage}: <strong>${totalPercentage}%</strong></div>
                `;
                
                // إعداد مخطط PDF مبسط Prepare simplified PDF diagram
                const pdfDiagram = document.getElementById('pdf-diagram');
                pdfDiagram.innerHTML = `
                    <div style="position: relative; width: 300px; height: 150px; margin: 0 auto;">
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; background: linear-gradient(135deg, #B22222, #8B0000); border-radius: 50%; display: flex; justify-content: center; align-items: center; color: white; font-weight: bold; font-size: 8px; text-align: center; border: 2px solid white; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                            ${currentLang === 'ar' ? 'الهدف:<br>الجودة' : 'Goal:<br>Quality'}
                        </div>
                        <div style="position: absolute; top: 20px; right: 20px; width: 70px; height: 50px; background: white; border-radius: 5px; border: 2px solid #B22222; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 10px; padding: 5px;">
                            <div style="font-weight: bold;">${translations[currentLang].serviceTitle}</div>
                            <div style="font-size: 12px; font-weight: bold;">${document.querySelector('#service-box .axis-score').textContent}</div>
                            <div>${translations[currentLang].from} <span style="font-weight: bold;">${document.querySelector('#service-box .axis-number').textContent}</span></div>
                        </div>
                        <div style="position: absolute; top: 20px; left: 20px; width: 70px; height: 50px; background: white; border-radius: 5px; border: 2px solid #8B0000; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 10px; padding: 5px;">
                            <div style="font-weight: bold;">${translations[currentLang].cleanlinessTitle}</div>
                            <div style="font-size: 12px; font-weight: bold;">${document.querySelector('#cleanliness-box .axis-score').textContent}</div>
                            <div>${translations[currentLang].from} <span style="font-weight: bold;">${document.querySelector('#cleanliness-box .axis-number').textContent}</span></div>
                        </div>
                        <div style="position: absolute; bottom: 20px; right: 20px; width: 70px; height: 50px; background: white; border-radius: 5px; border: 2px solid #A52A2A; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 10px; padding: 5px;">
                            <div style="font-weight: bold;">${translations[currentLang].equipmentTitle}</div>
                            <div style="font-size: 12px; font-weight: bold;">${document.querySelector('#equipment-box .axis-score').textContent}</div>
                            <div>${translations[currentLang].from} <span style="font-weight: bold;">${document.querySelector('#equipment-box .axis-number').textContent}</span></div>
                        </div>
                        <div style="position: absolute; bottom: 20px; left: 20px; width: 70px; height: 50px; background: white; border-radius: 5px; border: 2px solid #DC143C; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 10px; padding: 5px;">
                            <div style="font-weight: bold;">${translations[currentLang].managementTitle}</div>
                            <div style="font-size: 12px; font-weight: bold;">${document.querySelector('#management-box .axis-score').textContent}</div>
                            <div>${translations[currentLang].from} <span style="font-weight: bold;">${document.querySelector('#management-box .axis-number').textContent}</span></div>
                        </div>
                    </div>
                `;
                
                // إعداد جدول النتائج في PDF Prepare results table in PDF
                const pdfResultsBody = document.getElementById('pdf-results-body');
                pdfResultsBody.innerHTML = '';
                
                const categories = [
                    translations[currentLang].serviceTitle,
                    translations[currentLang].cleanlinessTitle,
                    translations[currentLang].equipmentTitle,
                    translations[currentLang].managementTitle,
                    translations[currentLang].qualitySection
                ];
                
                // حساب الدرجات المحققة لكل محور Calculate achieved scores for each axis
                let totalAchievedForPDF = 0;
                let totalMaxForPDF = 0;
                
                categories.forEach((category, index) => {
                    let achieved = 0;
                    let availableMax = 0;
                    const categoryData = evaluationData[Object.keys(evaluationData)[index]];
                    
                    categoryData.forEach(item => {
                        const notAvailableCheckbox = document.querySelector(`input[data-id="na-${item.id}"]`);
                        const isNotAvailable = notAvailableCheckbox && notAvailableCheckbox.checked;
                        
                        if (!isNotAvailable) {
                            availableMax += item.maxScore;
                            const scoreInput = document.getElementById(`score-${item.id}`);
                            achieved += parseInt(scoreInput.value) || 0;
                        }
                    });
                    
                    totalAchievedForPDF += achieved;
                    totalMaxForPDF += availableMax;
                    const percentage = availableMax > 0 ? Math.round((achieved / availableMax) * 100) : 0;
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td style="padding: 6px; border: 1px solid #000; text-align: center;">${category}</td>
                        <td style="padding: 6px; border: 1px solid #000; text-align: center;">${availableMax}</td>
                        <td style="padding: 6px; border: 1px solid #000; text-align: center;">${achieved}</td>
                        <td style="padding: 6px; border: 1px solid #000; text-align: center; background-color: ${getPercentageColor(percentage)}; color: black;">${percentage}%</td>
                    `;
                    pdfResultsBody.appendChild(row);
                });
                
                // إضافة صف الإجمالي Add Total Row
                const totalRow = document.createElement('tr');
                totalRow.innerHTML = `
                    <td style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: bold;">${translations[currentLang].from} 1-5</td>
                    <td style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: bold;">${totalMaxForPDF}</td>
                    <td style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: bold;">${totalAchievedForPDF}</td>
                    <td style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: bold; background-color: ${getPercentageColor(totalPercentage)}; color: black;">${totalPercentage}%</td>
                `;
                pdfResultsBody.appendChild(totalRow);
                
                // إضافة التقييم النهائي مع الدائرة الملونة Add final evaluation with colored circle
                const finalCircleColor = getPercentageColorForCircle(totalPercentage);
                document.getElementById('pdf-final-evaluation').innerHTML = `
                    <div>${evaluationText}</div>
                `;
                
                // تحديث الدائرة الملونة في PDF Update colored circle in PDF
                const pdfFinalCircle = document.getElementById('pdf-final-circle');
                pdfFinalCircle.style.backgroundColor = finalCircleColor;
                pdfFinalCircle.textContent = totalPercentage + '%';
                pdfFinalCircle.style.color = 'white';
                
                // إعداد العنصر للتصوير Prepare element for capture
                const element = document.getElementById('pdf-template');
                const originalStyles = {
                    display: element.style.display,
                    position: element.style.position,
                    left: element.style.left,
                    top: element.style.top,
                    width: element.style.width,
                    height: element.style.height,
                    zIndex: element.style.zIndex,
                    direction: element.style.direction
                };
                
                element.style.display = 'block';
                element.style.position = 'fixed';
                element.style.left = '0';
                element.style.top = '0';
                element.style.width = '794px';
                element.style.height = '1123px';
                element.style.zIndex = '10000';
                element.style.background = 'white';
                element.style.padding = '20px';
                element.style.direction = currentLang === 'ar' ? 'rtl' : 'ltr';
                
                // استخدام html2canvas لالتقاط الصورة Use html2canvas to capture image
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#FFFFFF',
                    width: 794,
                    height: 1123,
                    windowWidth: 794,
                    windowHeight: 1123
                });
                
                // إعادة العنصر إلى وضعه الأصلي Restore element to original position
                element.style.display = originalStyles.display;
                element.style.position = originalStyles.position;
                element.style.left = originalStyles.left;
                element.style.top = originalStyles.top;
                element.style.width = originalStyles.width;
                element.style.height = originalStyles.height;
                element.style.zIndex = originalStyles.zIndex;
                element.style.direction = originalStyles.direction;
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const pdf = new window.jspdf.jsPDF('p', 'pt', 'a4');
                
                const imgWidth = pdf.internal.pageSize.getWidth();
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                // إضافة الصورة إلى PDF Add image to PDF
                pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                
                // حفظ ملف PDF Save PDF file
                const restaurantName = selectedRestaurant ? selectedRestaurant.replace(/\s+/g, '_') : (currentLang === 'ar' ? 'تقييم' : 'Evaluation');
                const fileName = `${currentLang === 'ar' ? 'تقييم' : 'Evaluation'}_${restaurantName}_${formattedDate}.pdf`;
                pdf.save(fileName);
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                alert((currentLang === 'ar' ? 'حدث خطأ أثناء إنشاء ملف PDF: ' : 'Error occurred while generating PDF: ') + error.message);
            }
        }

        // طباعة التقرير Print Report
        function printEvaluation() {
            calculateResults();
            window.print();
        }

        // إعادة تعيين النموذج Reset Form
        function resetForm() {
            if (confirm(currentLang === 'ar' 
                ? 'هل أنت متأكد من إعادة تعيين جميع البيانات؟' 
                : 'Are you sure you want to reset all data?')) {
                document.querySelectorAll('.score-btn').forEach(btn => {
                    btn.textContent = '0';
                    btn.classList.remove('active');
                });
                
                document.querySelectorAll('input[type="hidden"]').forEach(input => {
                    input.value = '0';
                });
                
                document.querySelectorAll('.not-available-checkbox').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                document.querySelectorAll('input[type="text"]').forEach(input => {
                    input.value = '';
                });
                
                document.getElementById('evaluator-name').value = '';
                document.getElementById('restaurant-search').value = '';
                document.getElementById('selected-restaurant').value = '';
                document.getElementById('area-manager').textContent = '-';
                document.getElementById('operation-manager').textContent = '-';
                
                // إعادة تعيين مربعات المحاور Reset axis boxes
                document.querySelectorAll('.axis-box').forEach(box => {
                    const scoreElement = box.querySelector('.axis-score');
                    const axisNumber = box.querySelector('.axis-number');
                    
                    if (scoreElement) scoreElement.textContent = '0';
                    
                    // استعادة القيم الافتراضية Restore default values
                    const defaultValues = {
                        'service-box': '200',
                        'cleanliness-box': '300',
                        'equipment-box': '250',
                        'management-box': '250'
                    };
                    const boxId = box.id;
                    if (axisNumber) {
                        axisNumber.textContent = defaultValues[boxId] || '0';
                    }
                });
                
                calculateResults();
            }
        }

        // تهيئة النموذج عند تحميل الصفحة Initialize form when page loads
        document.addEventListener('DOMContentLoaded', initializeForm);
    </script>
</body>
</html>
